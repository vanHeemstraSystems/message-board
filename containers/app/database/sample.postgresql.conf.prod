# PostgreSQL configuration file example

# CONNECTIONS AND AUTHENTICATION
max_connections = 100                  # Maximum number of concurrent connections
superuser_reserved_connections = 3     # Number of connections reserved for superusers

# RESOURCE USAGE (except WAL)
shared_buffers = 256MB                 # Amount of memory the database server uses for shared memory buffers
effective_cache_size = 512MB           # Estimated size of database cache
work_mem = 4MB                         # Size of memory for internal sort operations and hash tables
maintenance_work_mem = 64MB            # Maximum memory to be used for maintenance operations

# WRITE-AHEAD LOG (WAL)
wal_level = replica                    # Minimal level of information written to WAL
max_wal_size = 1GB                     # Maximum size to let WAL grow
min_wal_size = 80MB                    # Minimum size to shrink WAL to
wal_buffers = 16MB                     # Size of WAL buffers

# CHECKPOINT PROCESSING
checkpoint_timeout = 15min             # Maximum time between automatic WAL checkpoints
checkpoint_completion_target = 0.9     # Writes data to disk more evenly during a checkpoint

# QUERY TUNING
random_page_cost = 1.1                 # Estimated cost of a non-sequentially accessed disk page
effective_io_concurrency = 1           # Number of simultaneous requests that can be handled efficiently

# LOGGING
logging_collector = on                 # Enable capturing of log messages to files
log_directory = 'log'                  # Directory where log files are written
log_filename = 'postgresql-%Y-%m-%d_%H%M%S.log'  # Log file name pattern
log_rotation_age = 1d                  # Rotate log files daily
log_rotation_size = 10MB               # Rotate log files when they reach 10MB

# ERROR HANDLING AND REPORTING
log_min_messages = warning             # Controls which message levels are logged
log_min_error_statement = error        # Controls which SQL statements are logged on error

# CHARACTER SET
default_text_search_config = 'pg_catalog.english'  # Default text search configuration

# PERFORMANCE MONITORING
track_activities = on                  # Collect information about running commands
track_counts = on                      # Collect statistics on database activity

# AUTOVACUUM PARAMETERS
autovacuum = on                        # Enable automatic maintenance of database
autovacuum_max_workers = 3             # Maximum number of autovacuum processes
autovacuum_vacuum_threshold = 50       # Minimum number of row updates before vacuum
autovacuum_analyze_threshold = 50      # Minimum number of row updates before analyze
autovacuum_vacuum_scale_factor = 0.2   # Fraction of table size to trigger vacuum
autovacuum_analyze_scale_factor = 0.1  # Fraction of table size to trigger analyze

# NETWORK SETTINGS
listen_addresses = '*'                 # What IP addresses to listen on
port = 5432                            # The port the server listens on

# SECURITY
password_encryption = scram-sha-256    # Use SCRAM-SHA-256 for password encryption